import*as l from"../web_modules/echarts.js";import{ahoi as d,EVisualizationType as m}from"../web_modules/@visahoi/echarts.js";import{importCsv as u}from"./utils.js";let r=null;async function h(){const n=await u("../data/oslo-2018.csv"),{x:e,y:a}=y(n),s=g(e,a);window.addEventListener("resize",()=>d(m.CHANGE_MATRIX,s,"#onboarding")),d(m.CHANGE_MATRIX,s,"#onboarding")}const p=["Tallin","Oslo","Munich"],f=[[0,2,-.6],[1,2,-8.4],[2,2,-2.2],[3,2,1.35],[4,2,-6.2],[5,2,1.1],[6,2,1.1],[7,2,-1.2],[8,2,3.8],[9,2,.5],[10,2,-1.45],[11,2,0],[0,1,-3.5],[1,1,-8.65],[2,1,-3.8],[3,1,-.5],[4,1,-2.4],[5,1,-3.55],[6,1,2],[7,1,.4],[8,1,.25],[9,1,-.3],[10,1,2.3],[11,1,.5],[0,0,.2],[1,0,-6.95],[2,0,-1.5],[3,0,-3.1],[4,0,-2.1],[5,0,-1],[6,0,.8],[7,0,1.1],[8,0,.95],[9,0,2],[10,0,2.65],[11,0,2.4]];function g(n,e){const a={title:{text:"Average temperature change in Â°C between 1990 and 1991",left:"center"},tooltip:{},grid:{height:"50%",top:"10%"},yAxis:{type:"category",data:p,name:"City",nameLocation:"middle",nameGap:35},xAxis:{type:"category",data:n,axisLabel:{formatter:function(s,o){var t=new Date(s);return t.getMonth()}},name:"Month",nameLocation:"middle",nameGap:30},series:[{type:"heatmap",data:f,label:{show:!1}}],visualMap:{min:-9,max:9,calculable:!0,orient:"horizontal",left:"center",bottom:"15%",color:["#D2B48C","#FDFDFD","#4682b4"],text:["High","Low"]}};return r.setOption(a),r}function y(n){const e=[],a=[];for(let o=0;o<n.length;o++){const t=n[o],i=`${t.year}-${t.month}`;if(e.includes(i)){const c=e.indexOf(i);a[c].push(parseFloat(t.temp))}else e.push(`${t.year}-${t.month}`),a.push([parseFloat(t.temp)])}const s=a.map(o=>{const t=o.reduce((i,c)=>i+c,0);return Math.round(t/o.length,2)});return{x:e,y:s}}const x=(n="svg")=>{const e=document.getElementById("vis");r=l.init(e,null,{renderer:n}),window.addEventListener("resize",()=>r.resize()),h()};export default x;
