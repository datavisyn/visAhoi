import u from"../web_modules/echarts.js";import*as c from"../web_modules/d3.js";import{ahoi as m}from"../web_modules/@visahoi/echarts.js";let l=null;function d(){c.csv("../data/oslo-2018.csv").then(r=>{const{x:t,y:s}=p(r),e=h(t,s);m("horizon-graph",e,"onboarding")})}function p(r){const t=[],s=[];for(let n=0;n<r.length;n++){const o=r[n],a=`${o.year}-${o.month}`;if(t.includes(a)){const i=t.indexOf(a);s[i].push(parseFloat(o.temp))}else t.push(`${o.year}-${o.month}`),s.push([parseFloat(o.temp)])}const e=s.map(n=>{const o=n.reduce((a,i)=>a+i,0);return Math.round(o/n.length,2)});return{x:t,y:e}}function h(r,t){const s={title:{text:"Average temperature in Oslo, Norway in 2018",left:"center"},tooltip:{trigger:"axis",axisPointer:{snap:!1,type:"none"},formatter:function(e,n,o){let a=0;a+=e[0].value,a+=e[1].value,a-=e[2].value;const i=`Month: ${e[0].name}<br/> Average temperature in °C: ${a}`;return setTimeout(function(){o(n,i)},100),i}},xAxis:{type:"category",boundaryGap:!1,data:r,axisLabel:{formatter:function(e,n){var o=new Date(e);return o.getMonth()+1}},name:"Month",nameLocation:"middle",nameGap:30},yAxis:{type:"value",min:-1,max:16,name:"Average Temperature in °C",nameLocation:"middle",nameGap:30},series:[{data:t.map(e=>e<0?0:e>15?15:e),type:"line",areaStyle:{opacity:.6},color:"#a1d76a",smooth:!0,symbol:"none",lineStyle:{width:0}},{data:t.map(e=>e>15?e-15:0),type:"line",areaStyle:{opacity:1},color:"#a1d76a",smooth:!0,symbol:"none",lineStyle:{width:0}},{data:t.map(e=>e<0?e*-1:0),type:"line",areaStyle:{opacity:1},color:"#0571b0",smooth:!0,symbol:"none",lineStyle:{width:0}}]};return l.setOption(s),l}const y=(r="svg")=>{const t=document.getElementById("vis");l=u.init(t,null,{renderer:r}),d()};export default y;
