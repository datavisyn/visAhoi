import c from"../web_modules/echarts.js";import*as i from"../web_modules/d3.js";import{onboarding as m}from"../web_modules/onboarding-echarts.js";let s=null;function d(){i.csv("../data/oslo-2018.csv").then(n=>{const{x:t,y:o}=g(n),e=p(t,o);m("change-matrix",e)})}const h=["Tallin","Oslo","Munich"],u=[[0,2,-.6],[1,2,-8.4],[2,2,-2.2],[3,2,1.35],[4,2,-6.2],[5,2,1.1],[6,2,1.1],[7,2,-1.2],[8,2,3.8],[9,2,.5],[10,2,-1.45],[11,2,0],[0,1,-3.5],[1,1,-8.65],[2,1,-3.8],[3,1,-.5],[4,1,-2.4],[5,1,-3.55],[6,1,2],[7,1,.4],[8,1,.25],[9,1,-.3],[10,1,2.3],[11,1,.5],[0,0,.2],[1,0,-6.95],[2,0,-1.5],[3,0,-3.1],[4,0,-2.1],[5,0,-1],[6,0,.8],[7,0,1.1],[8,0,.95],[9,0,2],[10,0,2.65],[11,0,2.4]];function p(n,t){const o={title:{text:"Average temperature change in Â°C between 1990 and 1991",left:"center"},tooltip:{},grid:{height:"50%",top:"10%"},yAxis:{type:"category",data:h,name:"City",nameLocation:"middle",nameGap:35},xAxis:{type:"category",data:n,axisLabel:{formatter:function(e,a){return new Date(e).getMonth()}},name:"Month",nameLocation:"middle",nameGap:30},series:[{type:"heatmap",data:u,label:{show:!1}}],visualMap:{min:-9,max:9,calculable:!0,orient:"horizontal",left:"center",bottom:"15%",color:["#D2B48C","#FDFDFD","#4682b4"],text:["High","Low"]}};return s.setOption(o),s}function g(n){const t=[],o=[];for(let e=0;e<n.length;e++){const a=n[e],r=`${a.year}-${a.month}`;t.includes(r)?o[t.indexOf(r)].push(parseFloat(a.temp)):(t.push(`${a.year}-${a.month}`),o.push([parseFloat(a.temp)]))}return{x:t,y:o.map(e=>{const a=e.reduce((r,l)=>r+l,0);return Math.round(a/e.length,2)})}}const f=(n="svg")=>{const t=document.getElementById("vis");s=c.init(t,null,{renderer:n}),d()};export default f;
